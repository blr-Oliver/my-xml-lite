[
  ["empty", "<script></script>", "", [], true],
  ["normal content", "<script>A</script>", "A", [], true],
  ["ci closed tag", "<script>A</ScRiPt>", "A", [], true],
  ["NUL in content", "<script>\u0000</script>", "\uFFFD", ["unexpected-null-character"], true],
  ["fake comment", "<script>A<!--B-->C</script>", "A<!--B-->C", [], true],
  ["fake comment -", "<script>A<!----->B</script>", "A<!----->B", [], true],
  ["fake comment NUL", "<script>A<!--\u0000-->B</script>", "A<!--\uFFFD-->B", ["unexpected-null-character"], true],
  ["fake comment dash NUL", "<script>A<!---\u0000-->B</script>", "A<!---\uFFFD-->B", ["unexpected-null-character"], true],
  ["fake comment dash dash NUL", "<script>A<!----\u0000-->B</script>", "A<!----\uFFFD-->B", ["unexpected-null-character"], true],
  ["fake comment missing start", "<script>A-->C</script>", "A-->C", [], true],
  ["fake comment broken start <", "<script>A<B-->C</script>", "A<B-->C", [], true],
  ["fake comment broken start <!", "<script>A<!B-->C</script>", "A<!B-->C", [], true],
  ["fake comment broken start <-", "<script>A<-B-->C</script>", "A<-B-->C", [], true],
  ["fake comment broken start <!-", "<script>A<!-B-->C</script>", "A<!-B-->C", [], true],
  ["fake comment broken start < + inner script", "<script>A<B<script>C</script>", "A<B<script>C", [], true],
  ["fake comment broken start <! + inner script", "<script>A<!B<script>C</script>", "A<!B<script>C", [], true],
  ["fake comment broken start <- + inner script", "<script>A<-B<script>C</script>", "A<-B<script>C", [], true],
  ["fake comment broken start <!- + inner script", "<script>A<!-B<script>C</script>", "A<!-B<script>C", [], true],
  ["fake comment broken start < + inner script inverted", "<script>A<B<script>-->C</script>", "A<B<script>-->C", [], true],
  ["fake comment broken start <! + inner script inverted", "<script>A<!B<script>-->C</script>", "A<!B<script>-->C", [], true],
  ["fake comment broken start <- + inner script inverted", "<script>A<-B<script>-->C</script>", "A<-B<script>-->C", [], true],
  ["fake comment broken start <!- + inner script inverted", "<script>A<!-B<script>-->C</script>", "A<!-B<script>-->C", [], true],
  ["fake comment broken end --", "<script>A<!--B--</script>", "A<!--B--", [], true],
  ["fake comment broken end -", "<script>A<!--B-</script>", "A<!--B-", [], true],
  ["fake comment broken end ->", "<script>A<!--B-></script>", "A<!--B->", [], true],
  ["fake comment broken end >", "<script>A<!--B></script>", "A<!--B>", [], true],
  ["fake comment no end", "<script>A<!--B</script>", "A<!--B", [], true],
  ["fake comment broken end -- + inner script", "<script>A<!--B--<script>C</script>", "A<!--B--<script>C</script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end - + inner script", "<script>A<!--B-<script>C</script>", "A<!--B-<script>C</script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end -> + inner script", "<script>A<!--B-><script>C</script>", "A<!--B-><script>C</script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end > + inner script", "<script>A<!--B><script>C</script>", "A<!--B><script>C</script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment no end + inner script", "<script>A<!--B<script></script>", "A<!--B<script></script>", ["eof-in-script-html-comment-like-text"], false],
  ["inner <script>", "<script>A<script>B</script>", "A<script>B", [], true],
  ["double escape", "<script>A<!--B<script>C</script>D-->E</script>", "A<!--B<script>C</script>D-->E", [], true],
  ["double escape NUL", "<script>A<!--B<script>\u0000</script>D-->E</script>", "A<!--B<script>\uFFFD</script>D-->E", ["unexpected-null-character"], true],
  ["double escape dash NUL", "<script>A<!--B<script>-\u0000</script>D-->E</script>", "A<!--B<script>-\uFFFD</script>D-->E", ["unexpected-null-character"], true],
  ["double escape dash dash NUL", "<script>A<!--B<script>--\u0000</script>D-->E</script>", "A<!--B<script>--\uFFFD</script>D-->E", ["unexpected-null-character"], true],
  ["double escape ws start", "<script>A<!--B<script C</script>D-->E</script>", "A<!--B<script C</script>D-->E", [], true],
  ["double escape ws end", "<script>A<!--B<script>C</script D-->E</script>", "A<!--B<script>C</script D-->E", [], true],
  ["double escape ws start + end", "<script>A<!--B<script C</script D-->E</script>", "A<!--B<script C</script D-->E", [], true],
  ["double escape self-closing start", "<script>A<!--B<script/C</script>D-->E</script>", "A<!--B<script/C</script>D-->E", [], true],
  ["double escape self-closing end", "<script>A<!--B<script>C</script/D-->E</script>", "A<!--B<script>C</script/D-->E", [], true],
  ["double escape self-closing start + end", "<script>A<!--B<script/C</script/D-->E</script>", "A<!--B<script/C</script/D-->E", [], true],
  ["double escape dash start", "<script>A<!---<script>C</script>D-->E</script>", "A<!---<script>C</script>D-->E", [], true],
  ["double escape dash dash start", "<script>A<!----<script>C</script>D-->E</script>", "A<!----<script>C</script>D-->E", [], true],
  ["double escape inverted close", "<script>A<!--B<script>C-->D</script>", "A<!--B<script>C-->D", [], true],
  ["double escape failed start <", "<script>A<!--B< script>C</script>", "A<!--B< script>C", [], true],
  ["double escape failed end ", "<script>A<!--B< script>C</script>", "A<!--B< script>C", [], true],
  ["double escape wrong end", "<script>A<!--B<script>C</xx>D</script>E-->F</script>", "A<!--B<script>C</xx>D</script>E-->F", [], true],
  ["wrong double escape matching", "<script>A<!--B<xx>C</xx>D--></script>", "A<!--B<xx>C</xx>D-->", [], true],
  ["wrong double escape non-matching", "<script>A<!--B<xx>C</yy>D--></script>", "A<!--B<xx>C</yy>D-->", [], true],
  ["wrong double escape start only", "<script>A<!--B<xx>C--></script>", "A<!--B<xx>C-->", [], true],
  ["wrong double escape end only", "<script>A<!--B</xx>C--></script>", "A<!--B</xx>C-->", [], true]
]