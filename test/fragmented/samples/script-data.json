[
  ["empty", "<script></script>", "", [], true],
  ["normal content", "<script>A</script>", "A", [], true],
  ["ci closed tag", "<script>A</ScRiPt>", "A", [], true],
  ["NUL in content", "<script>\u0000</script>", "\uFFFD", ["unexpected-null-character"], true],
  ["fake comment", "<script>A<!--B-->C</script>", "A<!--B-->C", [], true],
  ["fake comment -", "<script>A<!----->B</script>", "A<!----->B", [], true],
  ["fake comment NUL", "<script>A<!--\u0000-->B</script>", "A<!--\uFFFD-->B", ["unexpected-null-character"], true],
  ["fake comment dash NUL", "<script>A<!---\u0000-->B</script>", "A<!---\uFFFD-->B", ["unexpected-null-character"], true],
  ["fake comment dash dash NUL", "<script>A<!----\u0000-->B</script>", "A<!----\uFFFD-->B", ["unexpected-null-character"], true],
  ["fake comment missing start", "<script>A-->C</script>", "A-->C", [], true],
  ["fake comment broken start <", "<script>A<B-->C</script>", "A<B-->C", [], true],
  ["fake comment broken start <!", "<script>A<!B-->C</script>", "A<!B-->C", [], true],
  ["fake comment broken start <-", "<script>A<-B-->C</script>", "A<-B-->C", [], true],
  ["fake comment broken start <!-", "<script>A<!-B-->C</script>", "A<!-B-->C", [], true],
  ["fake comment broken start < + inner script", "<script>A<B<script>C</script>", "A<B<script>C", [], true],
  ["fake comment broken start < + inner script CI", "<script>A<B<ScRiPt>C</script>", "A<B<ScRiPt>C", [], true],
  ["fake comment broken start <! + inner script", "<script>A<!B<script>C</script>", "A<!B<script>C", [], true],
  ["fake comment broken start <! + inner script CI", "<script>A<!B<ScRiPt>C</script>", "A<!B<ScRiPt>C", [], true],
  ["fake comment broken start <- + inner script", "<script>A<-B<script>C</script>", "A<-B<script>C", [], true],
  ["fake comment broken start <- + inner script CI", "<script>A<-B<ScRiPt>C</script>", "A<-B<ScRiPt>C", [], true],
  ["fake comment broken start <!- + inner script", "<script>A<!-B<script>C</script>", "A<!-B<script>C", [], true],
  ["fake comment broken start <!- + inner script CI", "<script>A<!-B<ScRiPt>C</script>", "A<!-B<ScRiPt>C", [], true],
  ["fake comment broken start < + inner script inverted", "<script>A<B<script>-->C</script>", "A<B<script>-->C", [], true],
  ["fake comment broken start < + inner script inverted CI", "<script>A<B<ScRiPt>-->C</script>", "A<B<ScRiPt>-->C", [], true],
  ["fake comment broken start <! + inner script inverted", "<script>A<!B<script>-->C</script>", "A<!B<script>-->C", [], true],
  ["fake comment broken start <! + inner script inverted CI", "<script>A<!B<ScRiPt>-->C</script>", "A<!B<ScRiPt>-->C", [], true],
  ["fake comment broken start <- + inner script inverted", "<script>A<-B<script>-->C</script>", "A<-B<script>-->C", [], true],
  ["fake comment broken start <- + inner script inverted CI", "<script>A<-B<ScRiPt>-->C</script>", "A<-B<ScRiPt>-->C", [], true],
  ["fake comment broken start <!- + inner script inverted", "<script>A<!-B<script>-->C</script>", "A<!-B<script>-->C", [], true],
  ["fake comment broken start <!- + inner script inverted CI", "<script>A<!-B<ScRiPt>-->C</script>", "A<!-B<ScRiPt>-->C", [], true],
  ["fake comment broken end --", "<script>A<!--B--</script>", "A<!--B--", [], true],
  ["fake comment broken end -- CI", "<script>A<!--B--</ScRiPt>", "A<!--B--", [], true],
  ["fake comment broken end -", "<script>A<!--B-</script>", "A<!--B-", [], true],
  ["fake comment broken end - CI", "<script>A<!--B-</ScRiPt>", "A<!--B-", [], true],
  ["fake comment broken end ->", "<script>A<!--B-></script>", "A<!--B->", [], true],
  ["fake comment broken end -> CI", "<script>A<!--B-></ScRiPt>", "A<!--B->", [], true],
  ["fake comment broken end >", "<script>A<!--B></script>", "A<!--B>", [], true],
  ["fake comment broken end > CI", "<script>A<!--B></ScRiPt>", "A<!--B>", [], true],
  ["fake comment no end", "<script>A<!--B</script>", "A<!--B", [], true],
  ["fake comment no end", "<script>A<!--B</ScRiPt>", "A<!--B", [], true],
  ["fake comment broken end -- + inner script", "<script>A<!--B--<script>C</script>", "A<!--B--<script>C</script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end -- + inner script CI", "<script>A<!--B--<ScRiPt>C</sCrIpT>", "A<!--B--<ScRiPt>C</sCrIpT>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end - + inner script", "<script>A<!--B-<script>C</script>", "A<!--B-<script>C</script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end - + inner script CI", "<script>A<!--B-<ScRiPt>C</sCrIpT>", "A<!--B-<ScRiPt>C</sCrIpT>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end -> + inner script", "<script>A<!--B-><script>C</script>", "A<!--B-><script>C</script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end -> + inner script CI", "<script>A<!--B-><ScRiPt>C</sCrIpT>", "A<!--B-><ScRiPt>C</sCrIpT>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end > + inner script", "<script>A<!--B><script>C</script>", "A<!--B><script>C</script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment broken end > + inner script CI", "<script>A<!--B><ScRiPt>C</sCrIpT>", "A<!--B><ScRiPt>C</sCrIpT>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment no end + inner script", "<script>A<!--B<script></script>", "A<!--B<script></script>", ["eof-in-script-html-comment-like-text"], false],
  ["fake comment no end + inner script CI", "<script>A<!--B<ScRiPt></sCrIpT>", "A<!--B<ScRiPt></sCrIpT>", ["eof-in-script-html-comment-like-text"], false],
  ["inner <script>", "<script>A<script>B</script>", "A<script>B", [], true],
  ["inner <script> CI", "<script>A<ScRiPt>B</sCrIpT>", "A<ScRiPt>B", [], true],
  ["double escape", "<script>A<!--B<script>C</script>D-->E</script>", "A<!--B<script>C</script>D-->E", [], true],
  ["double escape CI", "<script>A<!--B<ScRiPt>C</sCrIpT>D-->E</script>", "A<!--B<ScRiPt>C</sCrIpT>D-->E", [], true],
  ["double escape NUL", "<script>A<!--B<script>\u0000</script>D-->E</script>", "A<!--B<script>\uFFFD</script>D-->E", ["unexpected-null-character"], true],
  ["double escape dash NUL", "<script>A<!--B<script>-\u0000</script>D-->E</script>", "A<!--B<script>-\uFFFD</script>D-->E", ["unexpected-null-character"], true],
  ["double escape dash dash NUL", "<script>A<!--B<script>--\u0000</script>D-->E</script>", "A<!--B<script>--\uFFFD</script>D-->E", ["unexpected-null-character"], true],
  ["double escape < start", "<script>A<!--B<<script>C</script>D-->E</script>", "A<!--B<<script>C</script>D-->E", [], true],
  ["double escape < start CI", "<script>A<!--B<<ScRiPt>C</sCrIpT>D-->E</script>", "A<!--B<<ScRiPt>C</sCrIpT>D-->E", [], true],
  ["double escape < end", "<script>A<!--B<script>C<</script>D-->E</script>", "A<!--B<script>C<</script>D-->E", [], true],
  ["double escape < end CI", "<script>A<!--B<ScRiPt>C<</sCrIpT>D-->E</script>", "A<!--B<ScRiPt>C<</sCrIpT>D-->E", [], true],
  ["double escape ws start", "<script>A<!--B<script C</script>D-->E</script>", "A<!--B<script C</script>D-->E", [], true],
  ["double escape ws start CI", "<script>A<!--B<ScRiPt C</sCrIpT>D-->E</script>", "A<!--B<ScRiPt C</sCrIpT>D-->E", [], true],
  ["double escape ws end", "<script>A<!--B<script>C</script D-->E</script>", "A<!--B<script>C</script D-->E", [], true],
  ["double escape ws end CI", "<script>A<!--B<ScRiPt>C</sCrIpT D-->E</script>", "A<!--B<ScRiPt>C</sCrIpT D-->E", [], true],
  ["double escape self-closing start", "<script>A<!--B<script/C</script>D-->E</script>", "A<!--B<script/C</script>D-->E", [], true],
  ["double escape self-closing start CI", "<script>A<!--B<ScRiPt/C</sCrIpT>D-->E</script>", "A<!--B<ScRiPt/C</sCrIpT>D-->E", [], true],
  ["double escape self-closing end", "<script>A<!--B<script>C</script/D-->E</script>", "A<!--B<script>C</script/D-->E", [], true],
  ["double escape self-closing end CI", "<script>A<!--B<ScRiPt>C</sCrIpT/D-->E</script>", "A<!--B<ScRiPt>C</sCrIpT/D-->E", [], true],
  ["double escape dash start", "<script>A<!---<script>C</script>D-->E</script>", "A<!---<script>C</script>D-->E", [], true],
  ["double escape dash start CI", "<script>A<!---<ScRiPt>C</sCrIpT>D-->E</script>", "A<!---<ScRiPt>C</sCrIpT>D-->E", [], true],
  ["double escape dash dash start", "<script>A<!----<script>C</script>D-->E</script>", "A<!----<script>C</script>D-->E", [], true],
  ["double escape dash dash start CI", "<script>A<!----<ScRiPt>C</sCrIpT>D-->E</script>", "A<!----<ScRiPt>C</sCrIpT>D-->E", [], true],
  ["double escape inverted close", "<script>A<!--B<script>C-->D</script>", "A<!--B<script>C-->D", [], true],
  ["double escape inverted close CI", "<script>A<!--B<ScRiPt>C-->D</script>", "A<!--B<ScRiPt>C-->D", [], true],
  ["double escape failed start <", "<script>A<!--B< script>C</script>", "A<!--B< script>C", [], true],
  ["double escape failed start < CI", "<script>A<!--B< ScRiPt>C</script>", "A<!--B< ScRiPt>C", [], true],
  ["double escape failed end", "<script>A<!--B<script>C< /script>D</script>E</script>", "A<!--B<script>C< /script>D</script>E", [], true],
  ["double escape failed end CI", "<script>A<!--B<ScRiPt>C< /ScrIpt>D</sCrIpT>E</script>", "A<!--B<ScRiPt>C< /ScrIpt>D</sCrIpT>E", [], true],
  ["double escape wrong end", "<script>A<!--B<script>C</xx>D</script>E-->F</script>", "A<!--B<script>C</xx>D</script>E-->F", [], true],
  ["double escape wrong end CI", "<script>A<!--B<ScRiPt>C</xx>D</sCrIpT>E-->F</script>", "A<!--B<ScRiPt>C</xx>D</sCrIpT>E-->F", [], true],
  ["wrong double escape matching", "<script>A<!--B<xx>C</xx>D--></script>", "A<!--B<xx>C</xx>D-->", [], true],
  ["wrong double escape non-matching", "<script>A<!--B<xx>C</yy>D--></script>", "A<!--B<xx>C</yy>D-->", [], true],
  ["wrong double escape start only", "<script>A<!--B<xx>C--></script>", "A<!--B<xx>C-->", [], true],
  ["wrong double escape end only", "<script>A<!--B</xx>C--></script>", "A<!--B</xx>C-->", [], true]
]